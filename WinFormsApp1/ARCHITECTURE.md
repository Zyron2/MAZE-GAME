# ??? Architecture & Design Diagrams

## System Architecture

```
???????????????????????????????????????????????????????????????
?                    USER INTERFACE LAYER                      ?
?                      Form1.cs (WinForms)                     ?
?  ????????????????????????????????????????????????????????   ?
?  ?  • Graphics Rendering (DrawMaze, DrawGameStatus)     ?   ?
?  ?  • Event Handling (KeyDown, Paint, Timer)            ?   ?
?  ?  • Game Loop (Timer-based 100ms updates)             ?   ?
?  ????????????????????????????????????????????????????????   ?
???????????????????????????????????????????????????????????????
                     ? Uses
                     ?
???????????????????????????????????????????????????????????????
?                  GAME LOGIC LAYER                            ?
?               GameController.cs                              ?
?  ????????????????????????????????????????????????????????   ?
?  ?  • Player Movement & Collision Detection            ?   ?
?  ?  • Monster AI Coordination                          ?   ?
?  ?  • Game State Management (Running/Won/Lost)         ?   ?
?  ?  • Score Tracking & High Score Integration          ?   ?
?  ????????????????????????????????????????????????????????   ?
???????????????????????????????????????????????????????????????
         ? Uses                 ? Uses                ? Uses
         ?                      ?                      ?
    ???????????          ???????????????      ????????????????
    ?  Maze   ?          ?  Monsters   ?      ?HighScoreTbl  ?
    ?  Data   ?          ?   AI        ?      ?   Sorting    ?
    ???????????          ???????????????      ????????????????
         ?                     ?
         ?                ????????????
   ?????????????         ?           ?
   ?Dictionary ?    ??????????  ?????????
   ? Map       ?    ? BFS    ?  ? DFS   ?
   ?"x,y"?char?    ?(Queue) ?  ?(Stack)?
   ?????????????    ??????????  ?????????
```

---

## Data Structure Relationships

```
Maze (Dictionary-based Storage)
?
?? Dictionary<string, char> mazeMap
?  ?? Key: "x,y" (e.g., "5,3")
?  ?? Value: Character ('#', ' ', 'P', 'E', 'M')
?
?? GetWalkableNeighbors(x, y) ? Graph Edges
?  ?? Returns up to 4 adjacent walkable cells
?
?? FindCharacter(char) ? Entity Positions
?  ?? Finds 'P' (Player)
?  ?? Finds 'E' (Exit)
?  ?? Finds 'M' (Monsters)
?
?? IsWalkable(x, y) ? Boolean
   ?? Checks if cell is not a wall
```

---

## Algorithm Flow - BFS (Queue)

```
MonsterBFS.MoveTowardsPlayer(playerX, playerY)
?
?? Initialize Queue
?  ?? Start: [(monsterX, monsterY, [path])]
?
?? Initialize HashSet<visited>
?  ?? Add starting position
?
?? While Queue not empty:
   ?
   ?? Dequeue current position
   ?
   ?? Check if player found
   ?  ?? YES: Return path[1] to move one step
   ?
   ?? For each walkable neighbor:
      ?
      ?? If not visited:
      ?  ?? Mark visited
      ?  ?? Create new path
      ?  ?? Enqueue (neighbor, new path)
      ?
      ?? Continue exploring (FIFO - level by level)

RESULT: Shortest path guaranteed! ?
Time: O(width × height)
Space: O(width × height)
```

---

## Algorithm Flow - DFS (Stack)

```
MonsterDFS.MoveTowardsPlayer(playerX, playerY)
?
?? Initialize Stack
?  ?? Start: [(monsterX, monsterY, [path])]
?
?? Initialize HashSet<visited>
?  ?? Add starting position
?
?? While Stack not empty (maxDepth limit):
   ?
   ?? Pop current position
   ?
   ?? Check if player found
   ?  ?? YES: Return path[1] to move one step
   ?
   ?? For each walkable neighbor (reverse order):
      ?
      ?? If not visited:
      ?  ?? Mark visited
      ?  ?? Create new path
      ?  ?? Push (neighbor, new path)
      ?
      ?? Continue exploring (LIFO - deep first)

RESULT: Non-optimal path, explores deeply
Time: O(width × height) limited
Space: O(depth)
```

---

## Sorting Algorithm Comparison

```
QUICKSORT
?? Partition around pivot
?? Recursively sort partitions
?? Time: O(n log n) avg, O(n²) worst
?? Space: O(log n)
?? In-place: YES

MERGESORT
?? Divide in half
?? Recursively sort halves
?? Merge sorted halves
?? Time: O(n log n) guaranteed
?? Space: O(n)
?? In-place: NO (needs temp array)

BUILT-IN (TIMSORT)
?? Hybrid of MergeSort + InsertionSort
?? Adapts to real-world data patterns
?? Time: O(n log n)
?? Space: O(1) or O(log n) adaptive
?? Best for typical use cases
```

---

## Game State Machine

```
                    ???????????????
                    ?    START    ?
                    ???????????????
                           ?
                           ?
                    ???????????????
         ????????????   RUNNING   ?????????????
         ?          ???????????????           ?
         ?                 ?                  ?
         ?      ???????????????????????       ?
         ?      ?          ?          ?       ?
         ?      ?          ?          ?       ?
         ?   WIN/LOST   COLLISION  TIMEOUT   ?
         ?      ?          ?          ?       ?
         ?      ???????????????????????       ?
         ?                 ?                  ?
    RESTART (R)            ?                  ?
         ?          ???????????????           ?
         ????????????   GAME OVER ?           ?
                    ???????????????           ?
                           ?                  ?
                     SHOW (H)               MOVE
                   High Scores             Player
```

---

## Maze as Graph

```
Cell (5,4) as Node in Graph
?
?? Up:    (5,3) ? Walkable edge
?? Down:  (5,5) ? Walkable edge
?? Left:  (4,4) ? Walkable edge
?? Right: (6,4) ? Walkable edge

Grid Example:
?????????????????????
? # # # # # # # # # ?
? # P . . # . . E # ?  Y=1
? # # . # # . # # # ?  Y=2
? #   M . .   .   # ?  Y=3
?????????????????????
  0 1 2 3 4 5 6 7 8

P at (1,1): Neighbors = {(2,1), (1,2)}
M at (2,3): Neighbors = {(1,3), (3,3), (2,2), ...}
E at (7,1): Neighbors = {(6,1), (7,2), ...}
```

---

## Memory Usage Diagram

```
For a 21×11 maze:

Dictionary (Maze Storage)
?? Hash buckets: ~231 entries
?? Memory: ~4KB (worst case)
?? Lookup: O(1) on average

BFS (Queue)
?? Queue size: up to 231 entries
?? Visited set: up to 231 entries
?? Path lists: duplicated entries
?? Total: ~30KB for pathfinding

DFS (Stack)
?? Stack size: up to depth (50)
?? Visited set: up to 231 entries
?? Path lists: duplicated entries
?? Total: ~20KB for pathfinding (less than BFS)

Scores (List)
?? Top 10 scores
?? Each ~60 bytes
?? Total: <1KB
```

---

## Class Dependency Graph

```
        ???????????????????
        ?     Form1       ? (UI/Graphics)
        ???????????????????
                 ?
                 ????????????????????????????
                 ?                          ?
                 ?                          ?
        ????????????????????      ????????????????????
        ? GameController   ?      ? System.Windows   ?
        ?                  ?      ? .Forms.Timer     ?
        ????????????????????      ????????????????????
                 ?
         ?????????????????????????????????????
         ?       ?        ?                  ?
         ?       ?        ?                  ?
    ??????? ???????????? ????????????? ????????????????
    ?Maze ? ?MonsterBFS? ?MonsterDFS ? ?HighScoreTbl  ?
    ??????? ???????????? ????????????? ????????????????
        ?         ?           ?               ?
        ?         ?           ?               ?
        ???????????????????????               ?
                  ?                           ?
            Uses:                      Uses:
            • Dictionary           • List
            • Queue (BFS)          • Sorting
            • Stack (DFS)          • File I/O
            • HashSet
```

---

## Performance Characteristics

```
OPERATION COMPLEXITY TABLE

Dictionary Lookup:    O(1)  ????
List Insert:          O(n)  ????????????????
Sort (QuickSort):     O(n²) ???????????????????? (worst)
Sort (MergeSort):     O(log n) ???????
BFS Pathfinding:      O(w×h) ??????????
DFS Pathfinding:      O(w×h) ??????????
Game Update:          O(1)  ????

Legend:
? = 1 operation unit (logarithmic scale)
```

---

## Monster AI Decision Tree

```
                    Monster.X, Monster.Y
                            ?
                            ?
                  Can reach Player?
                    /            \
                   YES             NO
                   ?               ?
                   ?               ?
            Use BFS to find    Check DFS path
            shortest path      with depth limit
                   ?               ?
                   ?               ?
            Return path[1]    Path found?
            (next step)      /        \
                   ?        YES        NO
                   ?        ?          ?
                   ?        ?          ?
                   ?   Return path[1]  Random
                   ?   (next step)     movement
                   ?        ?          ?
                   ?????????????????????
                            ?
                            ?
                    Move Monster to
                  (monsterX+dx, monsterY+dy)
```

---

## Rendering Pipeline

```
Form1.Paint Event Triggered
    ?
    ?? Clear background (black)
    ?
    ?? For each cell in maze:
    ?  ?? Get cell character
    ?  ?? Determine color:
    ?  ?  ?? '#' ? Dark Gray (wall)
    ?  ?  ?? ' ' ? White (empty)
    ?  ?  ?? 'P' ? Green (player)
    ?  ?  ?? 'M' ? Red (monster)
    ?  ?  ?? 'E' ? Gold (exit)
    ?  ?
    ?  ?? Draw rectangle with border
    ?
    ?? Draw status text
    ?  ?? Time elapsed
    ?
    ?? If game over:
       ?? Draw semi-transparent overlay
       ?? Draw game over message + instructions
```

---

## High Score Persistence

```
Add Score
   ?
   ?? Create ScoreEntry object
   ?? Add to List
   ?? Call Sort() [uses system sort]
   ?? Keep only top 10
   ?
   ?? Call SaveScores()
      ?
      ?? Write to file (highscores.txt)
         ?? Format: "Name|Time|Date"

Load Game
   ?
   ?? Call LoadScores()
      ?
      ?? Read from file (if exists)
         ?? Parse entries back to List
            ?? Sort by time
```

---

## Summary Architecture

```
3-TIER ARCHITECTURE

PRESENTATION TIER
?? Form1.cs
?? Graphics rendering
?? Event handling

BUSINESS LOGIC TIER
?? GameController.cs
?? Game rules
?? State management

DATA TIER
?? Maze.cs (Dictionary)
?? HighScoreTable.cs (List)
?? MonsterBFS/DFS.cs (AI)
?? Persistence (files)
```

---

This architecture provides:
? Clear separation of concerns
? Easy to test and extend
? Modular design
? Efficient data structures
? Scalable algorithms
